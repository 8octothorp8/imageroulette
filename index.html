<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tikolu Random Image Finder</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 20px;
    }
    img {
        max-width: 90%;
        max-height: 80vh;
        border: 2px solid #ccc;
        border-radius: 6px;
        margin-top: 10px;
    }
    .entry {
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
        display: block;
    }
</style>
</head>
<body>

<h2>Tikolu Random Image Finder</h2>

<div id="status">loading…</div>
<div id="list"></div>

<script>
function randomCode() {
    const letters = "abcdefghijklmnopqrstuvwxyz";
    let out = "";
    for (let i = 0; i < 5; i++) {
        out += letters[Math.floor(Math.random() * letters.length)];
    }
    return out;
}

function tryImage(url) {
    return new Promise((resolve, reject) => {
        const img = new Image();
        img.onload = () => resolve("loaded");
        img.onerror = () => reject("error");
        img.src = url;
    });
}

async function startLoop() {
    let attempts = 0;
    const status = document.getElementById("status");
    const list = document.getElementById("list");

    while (true) {
        attempts++;
        status.textContent = `Searching… tried ${attempts} codes`;

        const code = randomCode();
        const url = "https://tikolu.net/i/" + code;

        try {
            await tryImage(url);

            // Create a new entry block
            const entry = document.createElement("div");
            entry.className = "entry";

            // URL text
            const linkText = document.createElement("div");
            linkText.textContent = url;

            // Show button
            const btn = document.createElement("button");
            btn.textContent = "show?";
            btn.onclick = () => {
                const img = document.createElement("img");
                img.src = url;
                entry.appendChild(img);
                btn.disabled = true;
            };

            entry.appendChild(linkText);
            entry.appendChild(btn);
            list.appendChild(entry);

        } catch {
            // just skip failed attempts
        }

        // tiny delay so the browser doesn't freeze
        await new Promise(res => setTimeout(res, 10));
    }
}

startLoop();
</script>

</body>
</html>
